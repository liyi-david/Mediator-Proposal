automaton <T:type> Sync (A: in T, B: out T) {
    transitions {
        _ -> A.reqRead := B.reqRead ;
        _ -> B.reqWrite := A.reqWrite ;

        (A.reqWrite && B.reqRead) -> {
            perform A;
            B.value := A.value;
            perform B;
        }
    }
}